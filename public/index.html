<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Colors Catcher</title>
    <meta name="description" content="Capturer des couleurs üì∏üåà !" />
    <meta name="theme-color" content="#2d2d2d" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/png" href="icons/icon-192-framed.png" />
    <link rel="apple-touch-icon" href="icons/icon-192-framed.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="ColorCatcher" />

    <link rel="stylesheet" href="styles/index.css" />
    <link rel="stylesheet" href="pwa-install.css" />
  </head>
  <body>
    <header>
      <h1 class="colorscatcher">Colors Catcher</h1>

      <button
        class="btn-open-settings"
        type="button"
        aria-label="Ouvrir les r√©glages"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="#000000"
          viewBox="0 0 256 256"
          aria-hidden="true"
        >
          <path
            d="M40,88H73a32,32,0,0,0,62,0h81a8,8,0,0,0,0-16H135a32,32,0,0,0-62,0H40a8,8,0,0,0,0,16Zm64-24A16,16,0,1,1,88,80,16,16,0,0,1,104,64ZM216,168H199a32,32,0,0,0-62,0H40a8,8,0,0,0,0,16h97a32,32,0,0,0,62,0h17a8,8,0,0,0,0-16Zm-48,24a16,16,0,1,1,16-16A16,16,0,0,1,168,192Z"
          ></path>
        </svg>
      </button>
    </header>

    <div class="capture">
      <div class="capture-palette-stage">
        <canvas id="canvas-palette"></canvas>
      </div>
      <div class="capture-camera-stage" aria-hidden="true">
        <div class="camera-stage-mount" id="cameraStageMount"></div>
      </div>
      <canvas id="canvas"></canvas>
    </div>

    <div class="sliders-container">
      <div class="swatch-slider">
        <input
          type="range"
          min="3"
          max="7"
          value="4"
          step="1"
          aria-label="Nombre de couleurs : 4"
        />
        <div class="swatch-meta">
          <span class="swatch-scale-label swatch-scale-label-min">1</span>
          <span class="swatch-count-indicator" aria-live="polite"
            >4 couleurs</span
          >
          <span class="swatch-scale-label swatch-scale-label-max">24</span>
        </div>
      </div>

      <div class="zoom-btns">
        <div class="wheel-range">
          <input
            class="zoom-wheel"
            type="range"
            min="1"
            max="1"
            value="1"
            step="0.1"
            disabled
          />
        </div>
        <div class="zoom-meta">
          <span class="zoom-scale-bound zoom-scale-min">1.0x</span>
          <span class="zoom-display">1.0x zoom</span>
          <span class="zoom-scale-bound zoom-scale-max">1.0x</span>
        </div>
      </div>
    </div>

    <!-- Palette Collection Panel -->
    <div class="collection-panel">
      <div class="collection-header">
        <h2>Captures</h2>
        <div class="collection-header-actions">
          <button class="btn-close-collection" type="button">√ó</button>
        </div>
      </div>
      <div class="collection-grid" id="collectionGrid">
        <!-- Palettes will be dynamically added here -->
      </div>
    </div>

    <div class="settings-panel" aria-hidden="true" hidden>
      <div class="settings-header">
        <h2>R√©glages</h2>
        <div class="settings-header-actions">
          <button
            class="btn-close-settings"
            type="button"
            aria-label="Fermer les r√©glages"
          >
            √ó
          </button>
        </div>
      </div>

      <div class="settings-content">
        <section
          class="settings-section"
          aria-labelledby="settingsAccountTitle"
        >
          <div class="settings-section-header">
            <h3 id="settingsAccountTitle">Compte</h3>
            <p id="communityAccountState">
              Non connecte au compte de publication.
            </p>
          </div>

          <div class="settings-field">
            <div class="settings-field-header">
              <label class="settings-label" for="communityEmailInput"
                >Email</label
              >
            </div>
            <input
              class="settings-text-input"
              id="communityEmailInput"
              type="email"
              autocomplete="email"
              placeholder="alexis@example.com"
            />
            <button
              class="settings-action-button"
              id="communityRequestCodeButton"
              type="button"
            >
              Recevoir un code
            </button>
            <p class="settings-hint" id="communityAuthHint" hidden></p>
          </div>

          <div class="settings-field" id="communityCodeField" hidden>
            <div class="settings-field-header">
              <label class="settings-label" for="communityCodeInput"
                >Code recu par email</label
              >
            </div>
            <input
              class="settings-text-input"
              id="communityCodeInput"
              type="text"
              inputmode="numeric"
              autocomplete="one-time-code"
              placeholder="123456"
            />
            <button
              class="settings-action-button"
              id="communityVerifyCodeButton"
              type="button"
            >
              Se connecter
            </button>
          </div>

          <button
            class="settings-secondary-button"
            id="communityLogoutButton"
            type="button"
            hidden
          >
            Se deconnecter
          </button>
        </section>

        <section
          class="settings-section"
          aria-labelledby="settingsCaptureTitle"
        >
          <div class="settings-section-header">
            <h3 id="settingsCaptureTitle">Qualit√© des photos</h3>
          </div>

          <div class="settings-field">
            <div class="settings-field-header">
              <label class="settings-label" for="settingsPhotoQualityRange"
                >Qualit√© d'image</label
              >
              <output
                class="settings-inline-value"
                id="settingsPhotoQualityValue"
                >88%</output
              >
            </div>

            <div
              class="swatch-slider settings-quality-slider"
              id="settingsPhotoQualitySlider"
            >
              <input
                id="settingsPhotoQualityRange"
                type="range"
                min="60"
                max="98"
                value="88"
                step="1"
                aria-label="Qualit√© d'image : 88%"
              />
              <div class="swatch-meta">
                <span class="swatch-scale-label swatch-scale-label-min"
                  >60%</span
                >
                <span
                  class="swatch-count-indicator"
                  data-settings-quality-display
                  >88%</span
                >
                <span class="swatch-scale-label swatch-scale-label-max"
                  >98%</span
                >
              </div>
            </div>

            <p class="settings-hint">
              Une qualit√© plus √©lev√©e donne de plus belles images, mais chaque
              capture prend plus de place sur votre appareil.
            </p>
          </div>
        </section>

        <section
          class="settings-section"
          aria-labelledby="settingsPaletteTitle"
        >
          <div class="settings-section-header">
            <h3 id="settingsPaletteTitle">M√©thode de d√©tection des couleurs</h3>
          </div>

          <div class="settings-field">
            <div
              class="settings-segment"
              role="group"
              aria-label="M√©thode de d√©tection des couleurs"
            >
              <button
                class="settings-segment-button"
                type="button"
                data-settings-algorithm="median-cut"
                aria-pressed="true"
              >
                Auto
              </button>
              <button
                class="settings-segment-button"
                type="button"
                data-settings-algorithm="grid"
                aria-pressed="false"
              >
                Grille
              </button>
            </div>
            <div class="settings-algorithm-panels">
              <section
                class="settings-algorithm-panel"
                data-settings-algorithm-panel="median-cut"
                aria-labelledby="settingsMedianCutTuningTitle"
              >
                <div class="settings-subsection-header">
                  <h4 id="settingsMedianCutTuningTitle">
                    R√©glages du mode Auto
                  </h4>
                  <p>
                    Analyse globale de l'image pour en extraire les couleurs
                    dominantes.
                  </p>
                </div>

                <div class="settings-field">
                  <div class="settings-field-header">
                    <label
                      class="settings-label"
                      for="settingsMedianCutPoolRange"
                      >Nombre de couleurs analys√©es</label
                    >
                    <output
                      class="settings-inline-value"
                      id="settingsMedianCutPoolValue"
                      >16</output
                    >
                  </div>
                  <div
                    class="swatch-slider settings-quality-slider"
                    id="settingsMedianCutPoolSlider"
                  >
                    <input
                      id="settingsMedianCutPoolRange"
                      type="range"
                      min="4"
                      max="64"
                      value="16"
                      step="1"
                      aria-label="Nombre de couleurs analys√©es : 16"
                    />
                    <div class="swatch-meta">
                      <span class="swatch-scale-label swatch-scale-label-min"
                        >4</span
                      >
                      <span
                        class="swatch-count-indicator"
                        data-settings-median-cut-pool-display
                        >16</span
                      >
                      <span class="swatch-scale-label swatch-scale-label-max"
                        >64</span
                      >
                    </div>
                  </div>
                  <p class="settings-hint">
                    Plus la valeur est √©lev√©e, plus la palette sera vari√©e, mais
                    l'analyse sera plus lente.
                  </p>
                </div>

                <div class="settings-field">
                  <div class="settings-field-header">
                    <label
                      class="settings-label"
                      for="settingsMedianCutPixelsRange"
                      >Pixels analys√©s (max)</label
                    >
                    <output
                      class="settings-inline-value"
                      id="settingsMedianCutPixelsValue"
                      >12,000</output
                    >
                  </div>
                  <div
                    class="swatch-slider settings-quality-slider"
                    id="settingsMedianCutPixelsSlider"
                  >
                    <input
                      id="settingsMedianCutPixelsRange"
                      type="range"
                      min="1000"
                      max="60000"
                      value="12000"
                      step="1000"
                      aria-label="Pixels analys√©s max : 12000"
                    />
                    <div class="swatch-meta">
                      <span class="swatch-scale-label swatch-scale-label-min"
                        >1k</span
                      >
                      <span
                        class="swatch-count-indicator"
                        data-settings-median-cut-pixels-display
                        >12k</span
                      >
                      <span class="swatch-scale-label swatch-scale-label-max"
                        >60k</span
                      >
                    </div>
                  </div>
                  <p class="settings-hint">
                    Am√©liore la pr√©cision pour les sc√®nes complexes, mais
                    ralentit le traitement.
                  </p>
                </div>
              </section>

              <section
                class="settings-algorithm-panel"
                data-settings-algorithm-panel="grid"
                aria-labelledby="settingsGridTuningTitle"
                hidden
              >
                <div class="settings-subsection-header">
                  <h4 id="settingsGridTuningTitle">R√©glages de la grille</h4>
                  <p>
                    Place plusieurs points de mesure sur l'image pour capturer
                    la couleur √† chaque emplacement.
                  </p>
                </div>

                <div class="settings-field">
                  <div class="settings-field-header">
                    <label class="settings-label" for="settingsGridColsRange"
                      >Colonnes de la grille</label
                    >
                    <output
                      class="settings-inline-value"
                      id="settingsGridColsValue"
                      >8</output
                    >
                  </div>
                  <div
                    class="swatch-slider settings-quality-slider"
                    id="settingsGridColsSlider"
                  >
                    <input
                      id="settingsGridColsRange"
                      type="range"
                      min="2"
                      max="20"
                      value="8"
                      step="1"
                      aria-label="Colonnes de la grille : 8"
                    />
                    <div class="swatch-meta">
                      <span class="swatch-scale-label swatch-scale-label-min"
                        >2</span
                      >
                      <span
                        class="swatch-count-indicator"
                        data-settings-grid-cols-display
                        >8</span
                      >
                      <span class="swatch-scale-label swatch-scale-label-max"
                        >20</span
                      >
                    </div>
                  </div>
                </div>

                <div class="settings-field">
                  <div class="settings-field-header">
                    <label class="settings-label" for="settingsGridRowsRange"
                      >Lignes de la grille</label
                    >
                    <output
                      class="settings-inline-value"
                      id="settingsGridRowsValue"
                      >5</output
                    >
                  </div>
                  <div
                    class="swatch-slider settings-quality-slider"
                    id="settingsGridRowsSlider"
                  >
                    <input
                      id="settingsGridRowsRange"
                      type="range"
                      min="2"
                      max="12"
                      value="5"
                      step="1"
                      aria-label="Lignes de la grille : 5"
                    />
                    <div class="swatch-meta">
                      <span class="swatch-scale-label swatch-scale-label-min"
                        >2</span
                      >
                      <span
                        class="swatch-count-indicator"
                        data-settings-grid-rows-display
                        >5</span
                      >
                      <span class="swatch-scale-label swatch-scale-label-max"
                        >12</span
                      >
                    </div>
                  </div>
                </div>

                <div class="settings-field">
                  <div class="settings-field-header">
                    <label class="settings-label" for="settingsGridRadiusRange"
                      >Taille du point de mesure</label
                    >
                    <output
                      class="settings-inline-value"
                      id="settingsGridRadiusValue"
                      >4 px</output
                    >
                  </div>
                  <div
                    class="swatch-slider settings-quality-slider"
                    id="settingsGridRadiusSlider"
                  >
                    <input
                      id="settingsGridRadiusRange"
                      type="range"
                      min="1"
                      max="12"
                      value="4"
                      step="1"
                      aria-label="Taille du point de mesure : 4 pixels"
                    />
                    <div class="swatch-meta">
                      <span class="swatch-scale-label swatch-scale-label-min"
                        >1</span
                      >
                      <span
                        class="swatch-count-indicator"
                        data-settings-grid-radius-display
                        >4</span
                      >
                      <span class="swatch-scale-label swatch-scale-label-max"
                        >12</span
                      >
                    </div>
                  </div>
                  <p class="settings-hint">
                    Un point plus grand capture la couleur moyenne d'une zone
                    plus large autour de chaque point de mesure.
                  </p>
                </div>
              </section>
            </div>
          </div>
        </section>

        <section
          class="settings-section"
          aria-labelledby="settingsScoringTitle"
        >
          <div class="settings-section-header">
            <h3 id="settingsScoringTitle">Tri des couleurs</h3>
            <p>
              Influencez la mani√®re dont les couleurs sont choisies pour
              composer la palette finale.
            </p>
          </div>

          <div class="settings-field">
            <div class="settings-field-header">
              <label class="settings-label" for="settingsScoringVibrancyRange"
                >Pr√©f√©rence pour les couleurs vives</label
              >
              <output
                class="settings-inline-value"
                id="settingsScoringVibrancyValue"
                >25</output
              >
            </div>
            <div
              class="swatch-slider settings-quality-slider"
              id="settingsScoringVibrancySlider"
            >
              <input
                id="settingsScoringVibrancyRange"
                type="range"
                min="0"
                max="100"
                value="25"
                step="1"
                aria-label="Pr√©f√©rence pour les couleurs vives : 25"
              />
              <div class="swatch-meta">
                <span class="swatch-scale-label swatch-scale-label-min">0</span>
                <span
                  class="swatch-count-indicator"
                  data-settings-scoring-vibrancy-display
                  >25</span
                >
                <span class="swatch-scale-label swatch-scale-label-max"
                  >100</span
                >
              </div>
            </div>
            <p class="settings-hint">
              Plus la valeur est √©lev√©e, plus les couleurs √©clatantes et
              satur√©es seront privil√©gi√©es.
            </p>
          </div>

          <div class="settings-field">
            <div class="settings-field-header">
              <label class="settings-label" for="settingsScoringContrastRange"
                >Contraste clair/fonc√©</label
              >
              <output
                class="settings-inline-value"
                id="settingsScoringContrastValue"
                >15</output
              >
            </div>
            <div
              class="swatch-slider settings-quality-slider"
              id="settingsScoringContrastSlider"
            >
              <input
                id="settingsScoringContrastRange"
                type="range"
                min="0"
                max="100"
                value="15"
                step="1"
                aria-label="Contraste clair/fonc√© : 15"
              />
              <div class="swatch-meta">
                <span class="swatch-scale-label swatch-scale-label-min">0</span>
                <span
                  class="swatch-count-indicator"
                  data-settings-scoring-contrast-display
                  >15</span
                >
                <span class="swatch-scale-label swatch-scale-label-max"
                  >100</span
                >
              </div>
            </div>
            <p class="settings-hint">
              Favorise les couleurs tr√®s claires ou tr√®s fonc√©es pour un plus
              grand contraste dans la palette.
            </p>
          </div>

          <div class="settings-field">
            <div class="settings-field-header">
              <label class="settings-label" for="settingsScoringRarityRange"
                >Bonus aux teintes rares</label
              >
              <output
                class="settings-inline-value"
                id="settingsScoringRarityValue"
                >20</output
              >
            </div>
            <div
              class="swatch-slider settings-quality-slider"
              id="settingsScoringRaritySlider"
            >
              <input
                id="settingsScoringRarityRange"
                type="range"
                min="0"
                max="100"
                value="20"
                step="1"
                aria-label="Bonus aux teintes rares : 20"
              />
              <div class="swatch-meta">
                <span class="swatch-scale-label swatch-scale-label-min">0</span>
                <span
                  class="swatch-count-indicator"
                  data-settings-scoring-rarity-display
                  >20</span
                >
                <span class="swatch-scale-label swatch-scale-label-max"
                  >100</span
                >
              </div>
            </div>
            <p class="settings-hint">
              Met en avant les teintes peu pr√©sentes dans l'image pour une
              palette plus originale.
            </p>
          </div>

          <div class="settings-field">
            <div class="settings-field-header">
              <label class="settings-label" for="settingsScoringDiversityRange"
                >√âcart entre les couleurs</label
              >
              <output
                class="settings-inline-value"
                id="settingsScoringDiversityValue"
                >40</output
              >
            </div>
            <div
              class="swatch-slider settings-quality-slider"
              id="settingsScoringDiversitySlider"
            >
              <input
                id="settingsScoringDiversityRange"
                type="range"
                min="0"
                max="100"
                value="40"
                step="1"
                aria-label="√âcart entre les couleurs : 40"
              />
              <div class="swatch-meta">
                <span class="swatch-scale-label swatch-scale-label-min">0</span>
                <span
                  class="swatch-count-indicator"
                  data-settings-scoring-diversity-display
                  >40</span
                >
                <span class="swatch-scale-label swatch-scale-label-max"
                  >100</span
                >
              </div>
            </div>
            <p class="settings-hint">
              Plus la valeur est √©lev√©e, plus les couleurs choisies seront
              diff√©rentes les unes des autres.
            </p>
          </div>
        </section>
      </div>
    </div>

    <div class="btn-containers">
      <div class="camera-preview-dock" id="cameraPreviewDock">
        <video
          class="camera-feed"
          autoplay
          muted
          playsinline
          webkit-playsinline
          disablepictureinpicture
          aria-label="Aper√ßu cam√©ra"
        ></video>
        <div
          class="sample-row-overlay"
          id="sampleRowOverlay"
          aria-hidden="true"
        ></div>
      </div>

      <div class="mini-output">
        <img class="output-img" id="photo" src="" aria-hidden="true" />
        <!-- <div class="output-palette" id="outputPalette"></div> -->
      </div>

      <div class="btns-camera">
        <div class="camera-actions">
          <button class="btn-rotate ml-auto" type="button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              fill="#000000"
              viewBox="0 0 256 256"
              aria-hidden="true"
            >
              <path
                d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56ZM156.81,166.4A48.21,48.21,0,0,1,96,163.77V168a8,8,0,0,1-16,0V144a8,8,0,0,1,8-8h24a8,8,0,0,1,0,16h-5.15a32.12,32.12,0,0,0,40.34,1.61,8,8,0,0,1,9.62,12.79ZM176,120a8,8,0,0,1-8,8H144a8,8,0,0,1,0-16h5.15a32.12,32.12,0,0,0-40.34-1.61A8,8,0,0,1,99.19,97.6,48.21,48.21,0,0,1,160,100.23V96a8,8,0,0,1,16,0Z"
              ></path>
            </svg>
          </button>

          <button class="btn-capture" type="button">
            <img src="logo/colorcatchers.svg" alt="" class="btn-shoot hidden" />
            <svg
              class="btn-on"
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              fill="#000000"
              viewBox="0 0 256 256"
              aria-hidden="true"
            >
              <path
                d="M116,128V48a12,12,0,0,1,24,0v80a12,12,0,0,1-24,0Zm66.55-82a12,12,0,0,0-13.1,20.1C191.41,80.37,204,103,204,128a76,76,0,0,1-152,0c0-25,12.59-47.63,34.55-61.95A12,12,0,0,0,73.45,46C44.56,64.78,28,94.69,28,128a100,100,0,0,0,200,0C228,94.69,211.44,64.78,182.55,46Z"
              ></path>
            </svg>
          </button>

          <div class="btns-actions">
            <button class="btn-view-collection" type="button">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                fill="#000000"
                viewBox="0 0 256 256"
                aria-hidden="true"
              >
                <path
                  d="M216,40H72A16,16,0,0,0,56,56V72H40A16,16,0,0,0,24,88V200a16,16,0,0,0,16,16H184a16,16,0,0,0,16-16V184h16a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM172,72a12,12,0,1,1-12,12A12,12,0,0,1,172,72Zm12,128H40V88H56v80a16,16,0,0,0,16,16H184Zm32-32H72V120.69l30.34-30.35a8,8,0,0,1,11.32,0L163.31,140,189,114.34a8,8,0,0,1,11.31,0L216,130.07V168Z"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="app.js"></script>
    <script type="module" src="collection-ui.js"></script>
    <script type="module" src="settings-ui.js"></script>
    <script src="pwa-install.js"></script>
    <!-- <script src="filters.js"></script> -->
  </body>
</html>
